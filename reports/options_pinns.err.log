Traceback (most recent call last):
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/asyncio/base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/josemelo/Desktop/dev/libs/notebook/.conda/lib/python3.11/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
t = np.linspace(0, config['maturity'], 100)
s = np.linspace(0, 4 * config['strike'], 100)
T, S = np.meshgrid(t, s)
inputs = torch.tensor(
    np.stack([T.flatten(), S.flatten()], axis=1), dtype=torch.float32)
surface = model(inputs).detach().numpy().reshape(T.shape)
mako_cmap = sns.color_palette("mako", as_cmap=True)
colorscale = [
    [i / 99, f"rgb({int(r * 255)},{int(g * 255)},{int(b * 255)})"]
    for i, (r, g, b, a) in enumerate(mako_cmap(np.linspace(0, 1, 100)))
]

# Create the surface with the custom mako colorscale
fig = go.Figure(data=[go.Surface(z=surface, x=T, y=S, colorscale=colorscale)])
fig.update_layout(
    title='Option Price',
    scene=dict(
        xaxis_title='t',
        yaxis_title='s',
        zaxis_title='V',
        camera=dict(eye=dict(x=-1.25, y=-1.25, z=1.25))
    ),
    autosize=True,
    height=600,
)
fig.show()
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mRuntimeError[0m                              Traceback (most recent call last)
Cell [0;32mIn[14], line 6[0m
[1;32m      3[0m T, S [38;5;241m=[39m np[38;5;241m.[39mmeshgrid(t, s)
[1;32m      4[0m inputs [38;5;241m=[39m torch[38;5;241m.[39mtensor(
[1;32m      5[0m     np[38;5;241m.[39mstack([T[38;5;241m.[39mflatten(), S[38;5;241m.[39mflatten()], axis[38;5;241m=[39m[38;5;241m1[39m), dtype[38;5;241m=[39mtorch[38;5;241m.[39mfloat32)
[0;32m----> 6[0m surface [38;5;241m=[39m [43mmodel[49m[43m([49m[43minputs[49m[43m)[49m[38;5;241;43m.[39;49m[43mdetach[49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mnumpy[49m[43m([49m[43m)[49m[38;5;241m.[39mreshape(T[38;5;241m.[39mshape)
[1;32m      7[0m mako_cmap [38;5;241m=[39m sns[38;5;241m.[39mcolor_palette([38;5;124m"[39m[38;5;124mmako[39m[38;5;124m"[39m, as_cmap[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m      8[0m colorscale [38;5;241m=[39m [
[1;32m      9[0m     [i [38;5;241m/[39m [38;5;241m99[39m, [38;5;124mf[39m[38;5;124m"[39m[38;5;124mrgb([39m[38;5;132;01m{[39;00m[38;5;28mint[39m(r[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m255[39m)[38;5;132;01m}[39;00m[38;5;124m,[39m[38;5;132;01m{[39;00m[38;5;28mint[39m(g[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m255[39m)[38;5;132;01m}[39;00m[38;5;124m,[39m[38;5;132;01m{[39;00m[38;5;28mint[39m(b[38;5;250m [39m[38;5;241m*[39m[38;5;250m [39m[38;5;241m255[39m)[38;5;132;01m}[39;00m[38;5;124m)[39m[38;5;124m"[39m]
[1;32m     10[0m     [38;5;28;01mfor[39;00m i, (r, g, b, a) [38;5;129;01min[39;00m [38;5;28menumerate[39m(mako_cmap(np[38;5;241m.[39mlinspace([38;5;241m0[39m, [38;5;241m1[39m, [38;5;241m100[39m)))
[1;32m     11[0m ]

[0;31mRuntimeError[0m: Numpy is not available

